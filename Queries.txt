Question 1:- Retrieve all customers who have placed an order in the last 30 days.

Answer:-

SELECT DISTINCT c.*
FROM customer c
JOIN orders o ON c.id =o.customer_id
WHERE o.order_date >= curdate()-interval 30 day;

Output:-

1	joe	    joe@gmail.com	123 main st
2	gayu	gayu@gmail.com	456 oak st


Question 2:- Get the total amount of all orders placed by each customer.

Answer:-

SELECT c.name, sum(o.totalAmount) AS total_spent
FROM customer c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.id;

Output:-

joe	    250.00
gayu	200.00


Question 3:-Update the price of Product C to 45.00

Answer:-

update products
set price = 45.00
where id =3;
SELECT * FROM products;

Output:-

1	product A	2500.00	Product A description
2	product B	3500.00	Product B description
3	product C	45.00	Product C description
			

Question 4:-Add a new column discount to the products table.

Answer:-

ALTER TABLE products
ADD COLUMN discount DECIMAL(10,2) DEFAULT 0;
SELECT * FROM products;

Output:-

1	product A	2500.00	Product A description	0.00
2	product B	3500.00	Product B description	0.00
3	product C	45.00	Product C description	0.00
				

Question 5:-Retrieve the top 3 products with the highest price.

Answer:-

SELECT *
FROM products
ORDER BY price DESC
LIMIT 3;

Output:-

2	product B	3500.00	Product B description	0.00
1	product A	2500.00	Product A description	0.00
3	product C	45.00	Product C description	0.00
				

Question 6:- Get the names of customers who have ordered Product A.

Answer:-

SELECT DISTINCT c.name FROM customer c
JOIN orders o ON c.id = o.customer_id
JOIN order_items oi ON o.id = oi.order_id
JOIN products p ON oi.product_id = p.id
WHERE p.name = 'Product A';

Output:-

  joe


Question 7:- Join the orders and customers tables to retrieve the customer's name and order date for each order.

Answer:-

SELECT c.name AS customer_name,
       o.order_date
FROM orders o
JOIN customer c ON o.customer_id = c.id;

Output:-

joe	2025-12-10
gayu	2025-11-30
joe	2025-10-31


Question 8:- Retrieve the orders with a total amount greater than 150.00.

Answer:-

SELECT *
FROM orders
WHERE totalAmount > 150.00;

Output:-

2	2	2025-11-30	200.00
			

Question 9:- Normalize the database by creating a separate table for order items and updating the orders table to reference the order_items table.

Answer:-

SELECT * FROM order_items;

Output:-

1	1	1	1
2	2	2	1
3	3	1	2
			

Question 10:- Retrieve the average total of all orders.

Answer:-

select avg(totalAmount) AS average_amount FROM orders;

Output:-

150.000000